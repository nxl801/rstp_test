<?xml version="1.0" encoding="utf-8"?><testsuites name="pytest tests"><testsuite name="pytest" errors="0" failures="8" skipped="0" tests="8" time="31.004" timestamp="2025-09-10T11:30:38.618734+08:00" hostname="DESKTOP-FDB8GR9"><testcase classname="tests.test_additional_rstp.TestAdditionalRSTP" name="test_port_state_transitions" time="4.077"><failure message="NameError: name 'interfaces' is not defined">self = &lt;test_additional_rstp.TestAdditionalRSTP object at 0x00000215FFF674D0&gt;
dut_manager = &lt;src.ssh_manager.SSHManager object at 0x00000215800B92B0&gt;
test_nodes = [&lt;src.ssh_manager.SSHManager object at 0x0000021580096850&gt;, &lt;src.ssh_manager.SSHManager object at 0x0000021580144050&gt;]
network_topology = &lt;src.network_topology.NetworkTopology object at 0x00000215800BA900&gt;
rstp_analyzer = &lt;src.rstp_analyzer.RSTPAnalyzer object at 0x00000215800BAA50&gt;

    def test_port_state_transitions(self, dut_manager, test_nodes,
                                  network_topology, rstp_analyzer):
        """TC.AUTO.1.5: 端口状态转换测试 - 验证Learning状态转换"""
        logger.info("开始端口状态转换测试")
    
        # 创建环形拓扑
&gt;       network_topology.create_ring_topology(use_rstp=True)

tests\test_additional_rstp.py:25: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
src\network_topology.py:486: in create_ring_topology
    self.configure_bridge_rstp(node, bridge_name, priority, interfaces)
src\network_topology.py:221: in configure_bridge_rstp
    self._configure_rstp_mstpd(node, bridge, priority)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

self = &lt;src.network_topology.NetworkTopology object at 0x00000215800BA900&gt;
node = &lt;src.ssh_manager.SSHManager object at 0x0000021580096850&gt;, bridge = 'br0', priority = 36864

    def _configure_rstp_mstpd(self, node: SSHManager, bridge: str, priority: int):
        node.execute_sudo(f"brctl stp {bridge} on")
&gt;       for iface in (interfaces or []):
                      ^^^^^^^^^^
E       NameError: name 'interfaces' is not defined

src\network_topology.py:268: NameError</failure></testcase><testcase classname="tests.test_additional_rstp.TestAdditionalRSTP" name="test_bpdu_propagation_and_keepalive" time="3.325"><failure message="NameError: name 'interfaces' is not defined">self = &lt;test_additional_rstp.TestAdditionalRSTP object at 0x00000215FFF679D0&gt;
dut_manager = &lt;src.ssh_manager.SSHManager object at 0x00000215800B92B0&gt;
test_nodes = [&lt;src.ssh_manager.SSHManager object at 0x0000021580096850&gt;, &lt;src.ssh_manager.SSHManager object at 0x0000021580144050&gt;]
network_topology = &lt;src.network_topology.NetworkTopology object at 0x00000215800BA900&gt;
rstp_analyzer = &lt;src.rstp_analyzer.RSTPAnalyzer object at 0x0000021580145BD0&gt;

    def test_bpdu_propagation_and_keepalive(self, dut_manager, test_nodes,
                                          network_topology, rstp_analyzer):
        """TC.AUTO.1.6: BPDU传播和保活机制测试"""
        logger.info("开始BPDU传播和保活机制测试")
    
        # 创建环形拓扑
&gt;       network_topology.create_ring_topology(use_rstp=True)

tests\test_additional_rstp.py:192: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
src\network_topology.py:486: in create_ring_topology
    self.configure_bridge_rstp(node, bridge_name, priority, interfaces)
src\network_topology.py:221: in configure_bridge_rstp
    self._configure_rstp_mstpd(node, bridge, priority)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

self = &lt;src.network_topology.NetworkTopology object at 0x00000215800BA900&gt;
node = &lt;src.ssh_manager.SSHManager object at 0x0000021580096850&gt;, bridge = 'br0', priority = 36864

    def _configure_rstp_mstpd(self, node: SSHManager, bridge: str, priority: int):
        node.execute_sudo(f"brctl stp {bridge} on")
&gt;       for iface in (interfaces or []):
                      ^^^^^^^^^^
E       NameError: name 'interfaces' is not defined

src\network_topology.py:268: NameError</failure></testcase><testcase classname="tests.test_additional_rstp.TestAdditionalRSTP" name="test_disabled_port_exclusion_enhanced" time="3.365"><failure message="NameError: name 'interfaces' is not defined">self = &lt;test_additional_rstp.TestAdditionalRSTP object at 0x00000215FFED3490&gt;
dut_manager = &lt;src.ssh_manager.SSHManager object at 0x00000215800B92B0&gt;
test_nodes = [&lt;src.ssh_manager.SSHManager object at 0x0000021580096850&gt;, &lt;src.ssh_manager.SSHManager object at 0x0000021580144050&gt;]
network_topology = &lt;src.network_topology.NetworkTopology object at 0x00000215800BA900&gt;
rstp_analyzer = &lt;src.rstp_analyzer.RSTPAnalyzer object at 0x0000021580146490&gt;

    def test_disabled_port_exclusion_enhanced(self, dut_manager, test_nodes,
                                            network_topology, rstp_analyzer):
        """TC.AUTO.1.7: 增强的禁用端口排除测试"""
        logger.info("开始增强的禁用端口排除测试")
    
        # 创建环形拓扑
&gt;       network_topology.create_ring_topology(use_rstp=True)

tests\test_additional_rstp.py:297: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
src\network_topology.py:486: in create_ring_topology
    self.configure_bridge_rstp(node, bridge_name, priority, interfaces)
src\network_topology.py:221: in configure_bridge_rstp
    self._configure_rstp_mstpd(node, bridge, priority)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

self = &lt;src.network_topology.NetworkTopology object at 0x00000215800BA900&gt;
node = &lt;src.ssh_manager.SSHManager object at 0x0000021580096850&gt;, bridge = 'br0', priority = 36864

    def _configure_rstp_mstpd(self, node: SSHManager, bridge: str, priority: int):
        node.execute_sudo(f"brctl stp {bridge} on")
&gt;       for iface in (interfaces or []):
                      ^^^^^^^^^^
E       NameError: name 'interfaces' is not defined

src\network_topology.py:268: NameError</failure></testcase><testcase classname="tests.test_advanced_rstp_mechanisms.TestAdvancedRSTPMechanisms" name="test_proposal_agreement_handshake" time="4.011"><failure message="NameError: name 'interfaces' is not defined">self = &lt;test_advanced_rstp_mechanisms.TestAdvancedRSTPMechanisms object at 0x00000215FFF67B10&gt;
dut_manager = &lt;src.ssh_manager.SSHManager object at 0x00000215800AE9E0&gt;
test_nodes = [&lt;src.ssh_manager.SSHManager object at 0x00000215802C82B0&gt;, &lt;src.ssh_manager.SSHManager object at 0x00000215800EAB10&gt;]
network_topology = &lt;src.network_topology.NetworkTopology object at 0x0000021580146850&gt;
rstp_analyzer = &lt;src.rstp_analyzer.RSTPAnalyzer object at 0x00000215802C8E90&gt;
convergence_monitor = &lt;conftest.convergence_monitor.&lt;locals&gt;.ConvergenceMonitor object at 0x00000215800B97F0&gt;

    def test_proposal_agreement_handshake(self, dut_manager, test_nodes,
                                         network_topology, rstp_analyzer,
                                         convergence_monitor):
        """测试RSTP的Proposal/Agreement握手机制
    
        验证点：
        1. 上游交换机发送带Proposal标志的BPDU
        2. 下游交换机进入同步状态，阻塞其他端口
        3. 下游交换机回复Agreement标志的BPDU
        4. 上游交换机快速转换到Forwarding状态
        """
        logger = logging.getLogger(__name__)
        logger.info("开始测试RSTP Proposal/Agreement握手机制")
    
        # 1. 创建环形拓扑：DUT - TestNode1 - TestNode2
&gt;       network_topology.create_ring_topology(use_rstp=True)

tests\test_advanced_rstp_mechanisms.py:50: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
src\network_topology.py:486: in create_ring_topology
    self.configure_bridge_rstp(node, bridge_name, priority, interfaces)
src\network_topology.py:221: in configure_bridge_rstp
    self._configure_rstp_mstpd(node, bridge, priority)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

self = &lt;src.network_topology.NetworkTopology object at 0x0000021580146850&gt;
node = &lt;src.ssh_manager.SSHManager object at 0x00000215802C82B0&gt;, bridge = 'br0', priority = 36864

    def _configure_rstp_mstpd(self, node: SSHManager, bridge: str, priority: int):
        node.execute_sudo(f"brctl stp {bridge} on")
&gt;       for iface in (interfaces or []):
                      ^^^^^^^^^^
E       NameError: name 'interfaces' is not defined

src\network_topology.py:268: NameError</failure></testcase><testcase classname="tests.test_advanced_rstp_mechanisms.TestAdvancedRSTPMechanisms" name="test_tcn_topology_change_notification" time="3.355"><failure message="NameError: name 'interfaces' is not defined">self = &lt;test_advanced_rstp_mechanisms.TestAdvancedRSTPMechanisms object at 0x00000215FFF67C50&gt;
dut_manager = &lt;src.ssh_manager.SSHManager object at 0x00000215800AE9E0&gt;
test_nodes = [&lt;src.ssh_manager.SSHManager object at 0x00000215802C82B0&gt;, &lt;src.ssh_manager.SSHManager object at 0x00000215800EAB10&gt;]
network_topology = &lt;src.network_topology.NetworkTopology object at 0x0000021580146850&gt;
rstp_analyzer = &lt;src.rstp_analyzer.RSTPAnalyzer object at 0x00000215802C9350&gt;

    def test_tcn_topology_change_notification(self, dut_manager, test_nodes,
                                             network_topology, rstp_analyzer):
        """测试TCN拓扑变更通知机制
    
        验证点：
        1. 正确的TCN触发条件（非边缘端口从Discarding/Learning转到Forwarding）
        2. TCN的泛洪传播机制（TC标志位BPDU从所有非边缘指定端口和根端口发出）
        3. MAC地址表老化时间缩短到Forward Delay值
        """
        logger = logging.getLogger(__name__)
        logger.info("开始测试TCN拓扑变更通知机制")
    
        # 1. 创建环形拓扑以便观察TCN传播
&gt;       network_topology.create_ring_topology(use_rstp=True)

tests\test_advanced_rstp_mechanisms.py:143: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
src\network_topology.py:486: in create_ring_topology
    self.configure_bridge_rstp(node, bridge_name, priority, interfaces)
src\network_topology.py:221: in configure_bridge_rstp
    self._configure_rstp_mstpd(node, bridge, priority)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

self = &lt;src.network_topology.NetworkTopology object at 0x0000021580146850&gt;
node = &lt;src.ssh_manager.SSHManager object at 0x00000215802C82B0&gt;, bridge = 'br0', priority = 36864

    def _configure_rstp_mstpd(self, node: SSHManager, bridge: str, priority: int):
        node.execute_sudo(f"brctl stp {bridge} on")
&gt;       for iface in (interfaces or []):
                      ^^^^^^^^^^
E       NameError: name 'interfaces' is not defined

src\network_topology.py:268: NameError</failure></testcase><testcase classname="tests.test_advanced_rstp_mechanisms.TestAdvancedRSTPMechanisms" name="test_edge_port_behavior" time="3.366"><failure message="NameError: name 'interfaces' is not defined">self = &lt;test_advanced_rstp_mechanisms.TestAdvancedRSTPMechanisms object at 0x00000215FFED3360&gt;
dut_manager = &lt;src.ssh_manager.SSHManager object at 0x00000215800AE9E0&gt;
test_nodes = [&lt;src.ssh_manager.SSHManager object at 0x00000215802C82B0&gt;, &lt;src.ssh_manager.SSHManager object at 0x00000215800EAB10&gt;]
network_topology = &lt;src.network_topology.NetworkTopology object at 0x0000021580146850&gt;

    def test_edge_port_behavior(self, dut_manager, test_nodes, network_topology):
        """测试边缘端口行为
    
        验证点：
        1. 立即转发（跳过Learning状态）
        2. 不产生TCN
        3. 收到BPDU后失去边缘端口身份
        """
        logger = logging.getLogger(__name__)
        logger.info("开始测试边缘端口行为")
    
        # 1. 创建简单拓扑
&gt;       network_topology.create_ring_topology(use_rstp=True)

tests\test_advanced_rstp_mechanisms.py:221: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
src\network_topology.py:486: in create_ring_topology
    self.configure_bridge_rstp(node, bridge_name, priority, interfaces)
src\network_topology.py:221: in configure_bridge_rstp
    self._configure_rstp_mstpd(node, bridge, priority)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

self = &lt;src.network_topology.NetworkTopology object at 0x0000021580146850&gt;
node = &lt;src.ssh_manager.SSHManager object at 0x00000215802C82B0&gt;, bridge = 'br0', priority = 36864

    def _configure_rstp_mstpd(self, node: SSHManager, bridge: str, priority: int):
        node.execute_sudo(f"brctl stp {bridge} on")
&gt;       for iface in (interfaces or []):
                      ^^^^^^^^^^
E       NameError: name 'interfaces' is not defined

src\network_topology.py:268: NameError</failure></testcase><testcase classname="tests.test_advanced_rstp_mechanisms.TestAdvancedRSTPMechanisms" name="test_shared_vs_point_to_point_links" time="3.345"><failure message="NameError: name 'interfaces' is not defined">self = &lt;test_advanced_rstp_mechanisms.TestAdvancedRSTPMechanisms object at 0x00000215FFED3820&gt;
dut_manager = &lt;src.ssh_manager.SSHManager object at 0x00000215800AE9E0&gt;
test_nodes = [&lt;src.ssh_manager.SSHManager object at 0x00000215802C82B0&gt;, &lt;src.ssh_manager.SSHManager object at 0x00000215800EAB10&gt;]
network_topology = &lt;src.network_topology.NetworkTopology object at 0x0000021580146850&gt;
convergence_monitor = &lt;conftest.convergence_monitor.&lt;locals&gt;.ConvergenceMonitor object at 0x00000215800B9940&gt;

    def test_shared_vs_point_to_point_links(self, dut_manager, test_nodes,
                                           network_topology, convergence_monitor):
        """测试不同链路类型的行为差异
    
        验证点：
        1. 点对点链路支持Proposal/Agreement握手
        2. 共享链路回退到基于计时器的收敛
        3. 链路类型的正确识别
        """
        logger = logging.getLogger(__name__)
        logger.info("开始测试不同链路类型的行为差异")
    
        # 1. 创建混合拓扑（包含不同类型的链路）
&gt;       network_topology.create_ring_topology(use_rstp=True)

tests\test_advanced_rstp_mechanisms.py:312: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
src\network_topology.py:486: in create_ring_topology
    self.configure_bridge_rstp(node, bridge_name, priority, interfaces)
src\network_topology.py:221: in configure_bridge_rstp
    self._configure_rstp_mstpd(node, bridge, priority)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

self = &lt;src.network_topology.NetworkTopology object at 0x0000021580146850&gt;
node = &lt;src.ssh_manager.SSHManager object at 0x00000215802C82B0&gt;, bridge = 'br0', priority = 36864

    def _configure_rstp_mstpd(self, node: SSHManager, bridge: str, priority: int):
        node.execute_sudo(f"brctl stp {bridge} on")
&gt;       for iface in (interfaces or []):
                      ^^^^^^^^^^
E       NameError: name 'interfaces' is not defined

src\network_topology.py:268: NameError</failure></testcase><testcase classname="tests.test_backup_port_simulation.TestBackupPortSimulation" name="test_backup_port_concept_verification" time="3.962"><failure message="NameError: name 'interfaces' is not defined">self = &lt;test_backup_port_simulation.TestBackupPortSimulation object at 0x0000021580094050&gt;
dut_manager = &lt;src.ssh_manager.SSHManager object at 0x00000215800D79B0&gt;
test_nodes = [&lt;src.ssh_manager.SSHManager object at 0x00000215800D59D0&gt;, &lt;src.ssh_manager.SSHManager object at 0x00000215802BCA50&gt;]
network_topology = &lt;src.network_topology.NetworkTopology object at 0x0000021580147750&gt;
rstp_analyzer = &lt;src.rstp_analyzer.RSTPAnalyzer object at 0x00000215802643B0&gt;

    def test_backup_port_concept_verification(self, dut_manager, test_nodes,
                                             network_topology, rstp_analyzer):
        """验证备份端口概念和检测逻辑
    
        注意：由于测试环境限制，无法创建真正的共享介质拓扑，
        此测试主要验证备份端口的概念理解和相关代码逻辑。
        """
        logger.info("开始备份端口概念验证测试")
    
        # 定义execute_method
        if hasattr(dut_manager, 'execute'):
            execute_method = dut_manager.execute
        elif hasattr(dut_manager, 'run'):
            execute_method = dut_manager.run
        else:
            execute_method = dut_manager.send_command
    
        # 创建基本拓扑
&gt;       network_topology.create_ring_topology(use_rstp=True)

tests\test_backup_port_simulation.py:38: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
src\network_topology.py:486: in create_ring_topology
    self.configure_bridge_rstp(node, bridge_name, priority, interfaces)
src\network_topology.py:221: in configure_bridge_rstp
    self._configure_rstp_mstpd(node, bridge, priority)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

self = &lt;src.network_topology.NetworkTopology object at 0x0000021580147750&gt;
node = &lt;src.ssh_manager.SSHManager object at 0x00000215800D59D0&gt;, bridge = 'br0', priority = 36864

    def _configure_rstp_mstpd(self, node: SSHManager, bridge: str, priority: int):
        node.execute_sudo(f"brctl stp {bridge} on")
&gt;       for iface in (interfaces or []):
                      ^^^^^^^^^^
E       NameError: name 'interfaces' is not defined

src\network_topology.py:268: NameError</failure></testcase><testcase time="0.001" /></testsuite></testsuites>