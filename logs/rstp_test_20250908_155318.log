2025-09-08 15:53:18,024 - root - INFO - 日志系统初始化完成，日志文件: logs\rstp_test_20250908_155318.log
2025-09-08 15:53:18,247 - SSH_DUT - INFO - SSH连接成功: DUT (192.168.1.123)
2025-09-08 15:53:18,247 - RSTPTest - INFO - 成功连接到DUT: DUT
2025-09-08 15:53:18,595 - SSH_TestNode1 - INFO - SSH连接成功: TestNode1 (192.168.13.136)
2025-09-08 15:53:18,595 - RSTPTest - INFO - 成功连接到节点: TestNode1
2025-09-08 15:53:18,907 - SSH_TestNode2 - INFO - SSH连接成功: TestNode2 (192.168.13.137)
2025-09-08 15:53:18,907 - RSTPTest - INFO - 成功连接到节点: TestNode2
2025-09-08 15:53:18,908 - RSTPTest - INFO - ============================================================
2025-09-08 15:53:18,908 - RSTPTest - INFO - 开始测试: test_topology_change_notification
2025-09-08 15:53:18,908 - RSTPTest - INFO - ============================================================
2025-09-08 15:53:18,910 - test_protocol_conformance - INFO - 开始拓扑变更通知测试
2025-09-08 15:53:18,910 - test_protocol_conformance - INFO - === 步骤1: 创建多网桥环形拓扑 ===
2025-09-08 15:53:19,258 - test_protocol_conformance - INFO - 创建网桥 rstp1 并启用RSTP
2025-09-08 15:53:19,493 - test_protocol_conformance - INFO - 创建网桥 rstp2 并启用RSTP
2025-09-08 15:53:19,730 - test_protocol_conformance - INFO - 创建网桥 rstp3 并启用RSTP
2025-09-08 15:53:20,098 - test_protocol_conformance - INFO - ✓ 连接 rstp1 <-> rstp2 via veth12a/veth12b
2025-09-08 15:53:20,465 - test_protocol_conformance - INFO - ✓ 连接 rstp2 <-> rstp3 via veth23a/veth23b
2025-09-08 15:53:20,838 - test_protocol_conformance - INFO - ✓ 连接 rstp3 <-> rstp1 via veth31a/veth31b
2025-09-08 15:53:20,838 - test_protocol_conformance - INFO - 等待RSTP初始收敛...
2025-09-08 15:53:30,840 - test_protocol_conformance - INFO - === 步骤2: 验证初始RSTP状态 ===
2025-09-08 15:53:30,848 - test_protocol_conformance - INFO - 
rstp1 RSTP状态:
2025-09-08 15:53:30,848 - test_protocol_conformance - INFO - ✓ RSTP角色分配正常
2025-09-08 15:53:30,849 - test_protocol_conformance - INFO -   Root ID:
2025-09-08 15:53:30,849 - test_protocol_conformance - INFO -   Bridge ID:
2025-09-08 15:53:30,849 - test_protocol_conformance - INFO -   Interface  Role       State      Cost     Pri.Nbr
2025-09-08 15:53:30,899 - test_protocol_conformance - INFO - 
rstp2 RSTP状态:
2025-09-08 15:53:30,900 - test_protocol_conformance - INFO - ✓ RSTP角色分配正常
2025-09-08 15:53:30,900 - test_protocol_conformance - INFO - ✓ 检测到阻塞端口（防止环路）
2025-09-08 15:53:30,900 - test_protocol_conformance - INFO -   Root ID:
2025-09-08 15:53:30,901 - test_protocol_conformance - INFO -   Bridge ID:
2025-09-08 15:53:30,901 - test_protocol_conformance - INFO -   Interface  Role       State      Cost     Pri.Nbr
2025-09-08 15:53:30,947 - test_protocol_conformance - INFO - 
rstp3 RSTP状态:
2025-09-08 15:53:30,948 - test_protocol_conformance - INFO - ✓ RSTP角色分配正常
2025-09-08 15:53:30,948 - test_protocol_conformance - INFO -   Root ID:
2025-09-08 15:53:30,948 - test_protocol_conformance - INFO -   Bridge ID:
2025-09-08 15:53:30,948 - test_protocol_conformance - INFO -   Interface  Role       State      Cost     Pri.Nbr
2025-09-08 15:53:30,949 - test_protocol_conformance - INFO - === 步骤3: 验证BPDU流量 ===
2025-09-08 15:53:30,949 - RSTPAnalyzer_DUT - INFO - 开始捕获BPDU包 (接口: veth12a, 数量: 5)
2025-09-08 15:53:36,046 - RSTPAnalyzer_DUT - INFO - 捕获到 2 个BPDU包
2025-09-08 15:53:36,047 - test_protocol_conformance - INFO - 变更前捕获到 2 个BPDU
2025-09-08 15:53:36,047 - test_protocol_conformance - INFO - === 步骤4: 触发拓扑变更 ===
2025-09-08 15:53:36,148 - test_protocol_conformance - INFO - 找到阻塞端口: veth12b
2025-09-08 15:53:36,200 - test_protocol_conformance - INFO - 断开活动链路: veth31a
2025-09-08 15:53:36,421 - test_protocol_conformance - INFO - ✓ 链路 veth31a 已断开
2025-09-08 15:53:36,421 - test_protocol_conformance - INFO - 等待RSTP重新收敛...
2025-09-08 15:53:41,430 - test_protocol_conformance - INFO - ✓ rstp1 状态已变化
2025-09-08 15:53:41,480 - test_protocol_conformance - INFO - ✓ rstp2 状态已变化
2025-09-08 15:53:41,481 - test_protocol_conformance - INFO - ✓ 原阻塞端口 veth12b 现在转发
2025-09-08 15:53:41,531 - test_protocol_conformance - INFO - ✓ rstp3 状态已变化
2025-09-08 15:53:41,577 - test_protocol_conformance - INFO - ✓ 链路 veth31a 已恢复
2025-09-08 15:53:46,578 - test_protocol_conformance - INFO - === 步骤5: 捕获拓扑变更BPDU ===
2025-09-08 15:53:46,578 - RSTPAnalyzer_DUT - INFO - 开始捕获BPDU包 (接口: veth12a, 数量: 10)
2025-09-08 15:53:56,646 - RSTPAnalyzer_DUT - INFO - 捕获到 5 个BPDU包
2025-09-08 15:53:56,646 - test_protocol_conformance - INFO - 变更后捕获到 5 个BPDU
2025-09-08 15:53:56,646 - test_protocol_conformance - INFO - === 步骤6: 最终验证 ===
2025-09-08 15:53:56,647 - test_protocol_conformance - INFO - ✓ 测试通过：检测到拓扑变更
2025-09-08 15:53:56,696 - test_protocol_conformance - INFO - 
rstp1 最终状态:
2025-09-08 15:53:56,747 - test_protocol_conformance - INFO - 
rstp2 最终状态:
2025-09-08 15:53:56,795 - test_protocol_conformance - INFO - 
rstp3 最终状态:
2025-09-08 15:53:56,796 - test_protocol_conformance - INFO - === 清理测试环境 ===
2025-09-08 15:53:57,346 - test_protocol_conformance - INFO - 拓扑变更通知测试完成
2025-09-08 15:53:57,347 - RSTPTest - INFO - 测试完成: test_topology_change_notification (耗时: 38.44秒)
2025-09-08 15:53:57,347 - RSTPTest - INFO - ============================================================

2025-09-08 15:53:57,348 - SSH_TestNode1 - INFO - SSH连接已关闭: TestNode1
2025-09-08 15:53:57,348 - SSH_TestNode2 - INFO - SSH连接已关闭: TestNode2
2025-09-08 15:53:57,349 - SSH_DUT - INFO - SSH连接已关闭: DUT
