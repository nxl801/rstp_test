2025-09-09 16:42:34,255 - root - INFO - 日志系统初始化完成，日志文件: logs\rstp_test_20250909_164234.log
2025-09-09 16:42:34,448 - SSH_DUT - INFO - SSH连接成功: DUT (192.168.1.123)
2025-09-09 16:42:34,449 - RSTPTest - INFO - 成功连接到DUT: DUT
2025-09-09 16:42:34,580 - SSH_TestNode1 - INFO - SSH连接成功: TestNode1 (192.168.13.136)
2025-09-09 16:42:34,581 - RSTPTest - INFO - 成功连接到节点: TestNode1
2025-09-09 16:42:34,698 - SSH_TestNode2 - INFO - SSH连接成功: TestNode2 (192.168.13.137)
2025-09-09 16:42:34,698 - RSTPTest - INFO - 成功连接到节点: TestNode2
2025-09-09 16:42:34,709 - RSTPTest - INFO - ============================================================
2025-09-09 16:42:34,710 - RSTPTest - INFO - 开始测试: test_root_bridge_hijack_attack
2025-09-09 16:42:34,710 - RSTPTest - INFO - ============================================================
2025-09-09 16:42:34,710 - test_security - INFO - 开始根网桥劫持攻击测试
2025-09-09 16:42:34,711 - NetworkTopology - INFO - 创建RSTP环形拓扑...
2025-09-09 16:42:34,711 - NetworkTopology - INFO - 可用节点数量: 3
2025-09-09 16:42:34,711 - NetworkTopology - INFO - 开始配置节点 1/3: DUT
2025-09-09 16:42:34,711 - NetworkTopology - INFO - 为节点 DUT 配置RSTP网桥...
2025-09-09 16:42:34,711 - NetworkTopology - INFO - 开始为 DUT 检测RSTP支持方法...
2025-09-09 16:42:34,712 - NetworkTopology - INFO - DUT: 开始检测RSTP支持方法...
2025-09-09 16:42:34,712 - NetworkTopology - INFO - DUT: 跳过OVS检测，使用统一的RSTP方法
2025-09-09 16:42:34,712 - NetworkTopology - INFO - DUT: 检查mstpd支持...
2025-09-09 16:42:34,717 - NetworkTopology - INFO - DUT: mstpd检查结果: code=1
2025-09-09 16:42:34,718 - NetworkTopology - INFO - DUT: 检查iproute2支持...
2025-09-09 16:42:34,766 - NetworkTopology - INFO - DUT: ip命令检查: code=0
2025-09-09 16:42:34,766 - NetworkTopology - INFO - DUT: 使用iproute2配置RSTP
2025-09-09 16:42:34,767 - NetworkTopology - INFO - DUT: 最终选择RSTP方法: iproute2
2025-09-09 16:42:34,767 - NetworkTopology - INFO - DUT 使用方法: iproute2
2025-09-09 16:42:34,767 - NetworkTopology - INFO - 清理 DUT 的旧网桥配置...
2025-09-09 16:42:35,077 - NetworkTopology - INFO - 为 DUT 配置RSTP (iproute2)...
2025-09-09 16:42:35,469 - NetworkTopology - INFO - DUT: RSTP已通过iproute2配置
2025-09-09 16:42:35,469 - NetworkTopology - INFO - DUT RSTP核心配置完成
2025-09-09 16:42:35,470 - NetworkTopology - INFO - 为 DUT 添加接口: ['eth0', 'eth2']
2025-09-09 16:42:35,470 - NetworkTopology - INFO - 添加接口 eth0 到 DUT 的网桥
2025-09-09 16:42:35,590 - NetworkTopology - INFO - 添加接口 eth2 到 DUT 的网桥
2025-09-09 16:42:35,714 - NetworkTopology - INFO - DUT 接口添加完成
2025-09-09 16:42:35,714 - NetworkTopology - INFO - 启动 DUT 的网桥 rstp0...
2025-09-09 16:42:35,770 - NetworkTopology - INFO - 验证 DUT 的RSTP配置...
2025-09-09 16:42:35,818 - NetworkTopology - INFO - DUT: STP/RSTP已启用
2025-09-09 16:42:35,867 - NetworkTopology - INFO - DUT 网桥配置验证完成
2025-09-09 16:42:35,867 - NetworkTopology - INFO - 节点 DUT RSTP配置完成
2025-09-09 16:42:35,867 - NetworkTopology - INFO - 开始配置节点 2/3: TestNode1
2025-09-09 16:42:35,867 - NetworkTopology - INFO - 为节点 TestNode1 配置RSTP网桥...
2025-09-09 16:42:35,868 - NetworkTopology - INFO - 开始为 TestNode1 检测RSTP支持方法...
2025-09-09 16:42:35,868 - NetworkTopology - INFO - TestNode1: 开始检测RSTP支持方法...
2025-09-09 16:42:35,868 - NetworkTopology - INFO - TestNode1: 跳过OVS检测，使用统一的RSTP方法
2025-09-09 16:42:35,868 - NetworkTopology - INFO - TestNode1: 检查mstpd支持...
2025-09-09 16:42:35,875 - NetworkTopology - INFO - TestNode1: mstpd检查结果: code=0
2025-09-09 16:42:35,875 - NetworkTopology - INFO - TestNode1: 检查mstpd服务状态...
2025-09-09 16:42:44,026 - NetworkTopology - INFO - TestNode1: mstpd服务状态: code=1, output=
2025-09-09 16:42:44,027 - NetworkTopology - INFO - TestNode1: 尝试启动mstpd服务...
2025-09-09 16:42:51,352 - NetworkTopology - INFO - TestNode1: mstpd启动命令结果: code=0, stderr=[sudo] admin 的密码：
2025-09-09 16:43:01,433 - NetworkTopology - INFO - TestNode1: mstpd启动后状态: code=1
2025-09-09 16:43:01,434 - NetworkTopology - INFO - TestNode1: mstpd启动失败，使用iproute2
2025-09-09 16:43:01,434 - NetworkTopology - INFO - TestNode1: 最终选择RSTP方法: iproute2
2025-09-09 16:43:01,434 - NetworkTopology - INFO - TestNode1 使用方法: iproute2
2025-09-09 16:43:01,434 - NetworkTopology - INFO - 清理 TestNode1 的旧网桥配置...
2025-09-09 16:43:17,150 - NetworkTopology - INFO - 为 TestNode1 配置RSTP (iproute2)...
2025-09-09 16:43:18,264 - NetworkTopology - INFO - TestNode1: RSTP已通过iproute2配置
2025-09-09 16:43:18,264 - NetworkTopology - INFO - TestNode1 RSTP核心配置完成
2025-09-09 16:43:18,265 - NetworkTopology - INFO - 为 TestNode1 添加接口: ['eth0', 'eth2']
2025-09-09 16:43:18,265 - NetworkTopology - INFO - 添加接口 eth0 到 TestNode1 的网桥
2025-09-09 16:43:18,598 - NetworkTopology - INFO - 添加接口 eth2 到 TestNode1 的网桥
2025-09-09 16:43:18,935 - NetworkTopology - INFO - TestNode1 接口添加完成
2025-09-09 16:43:18,935 - NetworkTopology - INFO - 启动 TestNode1 的网桥 br0...
2025-09-09 16:43:19,116 - NetworkTopology - INFO - 验证 TestNode1 的RSTP配置...
2025-09-09 16:43:19,164 - NetworkTopology - INFO - TestNode1: STP/RSTP已启用
2025-09-09 16:43:19,211 - NetworkTopology - INFO - TestNode1 网桥配置验证完成
2025-09-09 16:43:19,211 - NetworkTopology - INFO - 节点 TestNode1 RSTP配置完成
2025-09-09 16:43:19,212 - NetworkTopology - INFO - 开始配置节点 3/3: TestNode2
2025-09-09 16:43:19,212 - NetworkTopology - INFO - 为节点 TestNode2 配置RSTP网桥...
2025-09-09 16:43:19,212 - NetworkTopology - INFO - 开始为 TestNode2 检测RSTP支持方法...
2025-09-09 16:43:19,212 - NetworkTopology - INFO - TestNode2: 开始检测RSTP支持方法...
2025-09-09 16:43:19,212 - NetworkTopology - INFO - TestNode2: 跳过OVS检测，使用统一的RSTP方法
2025-09-09 16:43:19,213 - NetworkTopology - INFO - TestNode2: 检查mstpd支持...
2025-09-09 16:43:19,220 - NetworkTopology - INFO - TestNode2: mstpd检查结果: code=0
2025-09-09 16:43:19,220 - NetworkTopology - INFO - TestNode2: 检查mstpd服务状态...
2025-09-09 16:43:19,356 - NetworkTopology - INFO - TestNode2: mstpd服务状态: code=1, output=
2025-09-09 16:43:19,357 - NetworkTopology - INFO - TestNode2: 尝试启动mstpd服务...
2025-09-09 16:43:19,531 - NetworkTopology - INFO - TestNode2: mstpd启动命令结果: code=0, stderr=[sudo] admin 的密码：
2025-09-09 16:43:21,618 - NetworkTopology - INFO - TestNode2: mstpd启动后状态: code=1
2025-09-09 16:43:21,618 - NetworkTopology - INFO - TestNode2: mstpd启动失败，使用iproute2
2025-09-09 16:43:21,619 - NetworkTopology - INFO - TestNode2: 最终选择RSTP方法: iproute2
2025-09-09 16:43:21,619 - NetworkTopology - INFO - TestNode2 使用方法: iproute2
2025-09-09 16:43:21,619 - NetworkTopology - INFO - 清理 TestNode2 的旧网桥配置...
2025-09-09 16:43:22,148 - NetworkTopology - INFO - 为 TestNode2 配置RSTP (iproute2)...
2025-09-09 16:43:23,220 - NetworkTopology - INFO - TestNode2: RSTP已通过iproute2配置
2025-09-09 16:43:23,220 - NetworkTopology - INFO - TestNode2 RSTP核心配置完成
2025-09-09 16:43:23,220 - NetworkTopology - INFO - 为 TestNode2 添加接口: ['eth0', 'eth2']
2025-09-09 16:43:23,220 - NetworkTopology - INFO - 添加接口 eth0 到 TestNode2 的网桥
2025-09-09 16:43:23,555 - NetworkTopology - INFO - 添加接口 eth2 到 TestNode2 的网桥
2025-09-09 16:43:23,920 - NetworkTopology - INFO - TestNode2 接口添加完成
2025-09-09 16:43:23,921 - NetworkTopology - INFO - 启动 TestNode2 的网桥 br0...
2025-09-09 16:43:24,092 - NetworkTopology - INFO - 验证 TestNode2 的RSTP配置...
2025-09-09 16:43:24,141 - NetworkTopology - INFO - TestNode2: STP/RSTP已启用
2025-09-09 16:43:24,188 - NetworkTopology - INFO - TestNode2 网桥配置验证完成
2025-09-09 16:43:24,189 - NetworkTopology - INFO - 节点 TestNode2 RSTP配置完成
2025-09-09 16:43:24,189 - NetworkTopology - INFO - 环形拓扑创建完成
2025-09-09 16:43:29,552 - RSTPAnalyzer_DUT - WARNING - 无法获取详细网桥信息，返回默认值: br0
2025-09-09 16:43:29,709 - test_security - INFO - 初始根网桥: 
2025-09-09 16:43:29,710 - FaultInjector_TestNode1 - WARNING - 注入恶意BPDU到 eth0
2025-09-09 16:43:29,811 - FaultInjector_TestNode1 - WARNING - 恶意BPDU注入已启动 (优先级: 0)
2025-09-09 16:43:44,876 - RSTPAnalyzer_DUT - WARNING - 无法获取详细网桥信息，返回默认值: br0
2025-09-09 16:43:45,033 - test_security - INFO - 根网桥未被劫持（可能已启用防护）
2025-09-09 16:43:45,034 - test_security - INFO - 根网桥劫持攻击测试完成
2025-09-09 16:43:45,035 - RSTPTest - INFO - 测试完成: test_root_bridge_hijack_attack (耗时: 70.32秒)
2025-09-09 16:43:45,035 - RSTPTest - INFO - ============================================================

2025-09-09 16:43:45,036 - RSTPTest - INFO - ============================================================
2025-09-09 16:43:45,036 - RSTPTest - INFO - 开始测试: test_bpdu_flood_attack
2025-09-09 16:43:45,036 - RSTPTest - INFO - ============================================================
2025-09-09 16:43:45,037 - test_security - INFO - 开始BPDU洪泛攻击测试
2025-09-09 16:43:45,037 - NetworkTopology - INFO - 创建RSTP环形拓扑...
2025-09-09 16:43:45,037 - NetworkTopology - INFO - 可用节点数量: 3
2025-09-09 16:43:45,038 - NetworkTopology - INFO - 开始配置节点 1/3: DUT
2025-09-09 16:43:45,038 - NetworkTopology - INFO - 为节点 DUT 配置RSTP网桥...
2025-09-09 16:43:45,038 - NetworkTopology - INFO - 开始为 DUT 检测RSTP支持方法...
2025-09-09 16:43:45,038 - NetworkTopology - INFO - DUT: 使用缓存的RSTP方法: iproute2
2025-09-09 16:43:45,038 - NetworkTopology - INFO - DUT 使用方法: iproute2
2025-09-09 16:43:45,038 - NetworkTopology - INFO - 清理 DUT 的旧网桥配置...
2025-09-09 16:43:45,340 - NetworkTopology - INFO - 为 DUT 配置RSTP (iproute2)...
2025-09-09 16:43:45,733 - NetworkTopology - INFO - DUT: RSTP已通过iproute2配置
2025-09-09 16:43:45,733 - NetworkTopology - INFO - DUT RSTP核心配置完成
2025-09-09 16:43:45,734 - NetworkTopology - INFO - 为 DUT 添加接口: ['eth0', 'eth2']
2025-09-09 16:43:45,734 - NetworkTopology - INFO - 添加接口 eth0 到 DUT 的网桥
2025-09-09 16:43:45,853 - NetworkTopology - INFO - 添加接口 eth2 到 DUT 的网桥
2025-09-09 16:43:45,972 - NetworkTopology - INFO - DUT 接口添加完成
2025-09-09 16:43:45,973 - NetworkTopology - INFO - 启动 DUT 的网桥 rstp0...
2025-09-09 16:43:46,028 - NetworkTopology - INFO - 验证 DUT 的RSTP配置...
2025-09-09 16:43:46,078 - NetworkTopology - INFO - DUT: STP/RSTP已启用
2025-09-09 16:43:46,125 - NetworkTopology - INFO - DUT 网桥配置验证完成
2025-09-09 16:43:46,125 - NetworkTopology - INFO - 节点 DUT RSTP配置完成
2025-09-09 16:43:46,125 - NetworkTopology - INFO - 开始配置节点 2/3: TestNode1
2025-09-09 16:43:46,125 - NetworkTopology - INFO - 为节点 TestNode1 配置RSTP网桥...
2025-09-09 16:43:46,126 - NetworkTopology - INFO - 开始为 TestNode1 检测RSTP支持方法...
2025-09-09 16:43:46,126 - NetworkTopology - INFO - TestNode1: 使用缓存的RSTP方法: iproute2
2025-09-09 16:43:46,126 - NetworkTopology - INFO - TestNode1 使用方法: iproute2
2025-09-09 16:43:46,126 - NetworkTopology - INFO - 清理 TestNode1 的旧网桥配置...
2025-09-09 16:43:46,638 - NetworkTopology - INFO - 为 TestNode1 配置RSTP (iproute2)...
2025-09-09 16:43:47,683 - NetworkTopology - INFO - TestNode1: RSTP已通过iproute2配置
2025-09-09 16:43:47,684 - NetworkTopology - INFO - TestNode1 RSTP核心配置完成
2025-09-09 16:43:47,684 - NetworkTopology - INFO - 为 TestNode1 添加接口: ['eth0', 'eth2']
2025-09-09 16:43:47,684 - NetworkTopology - INFO - 添加接口 eth0 到 TestNode1 的网桥
2025-09-09 16:43:48,039 - NetworkTopology - INFO - 添加接口 eth2 到 TestNode1 的网桥
2025-09-09 16:43:48,365 - NetworkTopology - INFO - TestNode1 接口添加完成
2025-09-09 16:43:48,366 - NetworkTopology - INFO - 启动 TestNode1 的网桥 br0...
2025-09-09 16:43:48,531 - NetworkTopology - INFO - 验证 TestNode1 的RSTP配置...
2025-09-09 16:43:48,579 - NetworkTopology - INFO - TestNode1: STP/RSTP已启用
2025-09-09 16:43:48,628 - NetworkTopology - INFO - TestNode1 网桥配置验证完成
2025-09-09 16:43:48,629 - NetworkTopology - INFO - 节点 TestNode1 RSTP配置完成
2025-09-09 16:43:48,629 - NetworkTopology - INFO - 开始配置节点 3/3: TestNode2
2025-09-09 16:43:48,629 - NetworkTopology - INFO - 为节点 TestNode2 配置RSTP网桥...
2025-09-09 16:43:48,629 - NetworkTopology - INFO - 开始为 TestNode2 检测RSTP支持方法...
2025-09-09 16:43:48,629 - NetworkTopology - INFO - TestNode2: 使用缓存的RSTP方法: iproute2
2025-09-09 16:43:48,630 - NetworkTopology - INFO - TestNode2 使用方法: iproute2
2025-09-09 16:43:48,630 - NetworkTopology - INFO - 清理 TestNode2 的旧网桥配置...
2025-09-09 16:43:49,128 - NetworkTopology - INFO - 为 TestNode2 配置RSTP (iproute2)...
2025-09-09 16:43:50,182 - NetworkTopology - INFO - TestNode2: RSTP已通过iproute2配置
2025-09-09 16:43:50,182 - NetworkTopology - INFO - TestNode2 RSTP核心配置完成
2025-09-09 16:43:50,182 - NetworkTopology - INFO - 为 TestNode2 添加接口: ['eth0', 'eth2']
2025-09-09 16:43:50,183 - NetworkTopology - INFO - 添加接口 eth0 到 TestNode2 的网桥
2025-09-09 16:43:50,534 - NetworkTopology - INFO - 添加接口 eth2 到 TestNode2 的网桥
2025-09-09 16:43:50,901 - NetworkTopology - INFO - TestNode2 接口添加完成
2025-09-09 16:43:50,901 - NetworkTopology - INFO - 启动 TestNode2 的网桥 br0...
2025-09-09 16:43:51,073 - NetworkTopology - INFO - 验证 TestNode2 的RSTP配置...
2025-09-09 16:43:51,121 - NetworkTopology - INFO - TestNode2: STP/RSTP已启用
2025-09-09 16:43:51,170 - NetworkTopology - INFO - TestNode2 网桥配置验证完成
2025-09-09 16:43:51,170 - NetworkTopology - INFO - 节点 TestNode2 RSTP配置完成
2025-09-09 16:43:51,171 - NetworkTopology - INFO - 环形拓扑创建完成
2025-09-09 16:43:56,340 - test_security - INFO - 初始CPU使用率: 0.0%
2025-09-09 16:44:06,565 - test_security - INFO - 洪泛时CPU使用率: 33.3%
2025-09-09 16:44:06,721 - test_security - INFO - 网络在BPDU洪泛下保持稳定
2025-09-09 16:44:06,721 - test_security - INFO - BPDU洪泛攻击测试完成
2025-09-09 16:44:06,722 - RSTPTest - INFO - 测试完成: test_bpdu_flood_attack (耗时: 21.69秒)
2025-09-09 16:44:06,722 - RSTPTest - INFO - ============================================================

2025-09-09 16:44:06,724 - RSTPTest - INFO - ============================================================
2025-09-09 16:44:06,724 - RSTPTest - INFO - 开始测试: test_topology_change_attack
2025-09-09 16:44:06,724 - RSTPTest - INFO - ============================================================
2025-09-09 16:44:06,725 - test_security - INFO - 开始拓扑变更攻击测试
2025-09-09 16:44:06,725 - NetworkTopology - INFO - 创建RSTP环形拓扑...
2025-09-09 16:44:06,725 - NetworkTopology - INFO - 可用节点数量: 3
2025-09-09 16:44:06,725 - NetworkTopology - INFO - 开始配置节点 1/3: DUT
2025-09-09 16:44:06,725 - NetworkTopology - INFO - 为节点 DUT 配置RSTP网桥...
2025-09-09 16:44:06,726 - NetworkTopology - INFO - 开始为 DUT 检测RSTP支持方法...
2025-09-09 16:44:06,726 - NetworkTopology - INFO - DUT: 使用缓存的RSTP方法: iproute2
2025-09-09 16:44:06,726 - NetworkTopology - INFO - DUT 使用方法: iproute2
2025-09-09 16:44:06,726 - NetworkTopology - INFO - 清理 DUT 的旧网桥配置...
2025-09-09 16:44:07,048 - NetworkTopology - INFO - 为 DUT 配置RSTP (iproute2)...
2025-09-09 16:44:07,440 - NetworkTopology - INFO - DUT: RSTP已通过iproute2配置
2025-09-09 16:44:07,441 - NetworkTopology - INFO - DUT RSTP核心配置完成
2025-09-09 16:44:07,441 - NetworkTopology - INFO - 为 DUT 添加接口: ['eth0', 'eth2']
2025-09-09 16:44:07,441 - NetworkTopology - INFO - 添加接口 eth0 到 DUT 的网桥
2025-09-09 16:44:07,560 - NetworkTopology - INFO - 添加接口 eth2 到 DUT 的网桥
2025-09-09 16:44:07,679 - NetworkTopology - INFO - DUT 接口添加完成
2025-09-09 16:44:07,679 - NetworkTopology - INFO - 启动 DUT 的网桥 rstp0...
2025-09-09 16:44:07,733 - NetworkTopology - INFO - 验证 DUT 的RSTP配置...
2025-09-09 16:44:07,781 - NetworkTopology - INFO - DUT: STP/RSTP已启用
2025-09-09 16:44:07,828 - NetworkTopology - INFO - DUT 网桥配置验证完成
2025-09-09 16:44:07,829 - NetworkTopology - INFO - 节点 DUT RSTP配置完成
2025-09-09 16:44:07,829 - NetworkTopology - INFO - 开始配置节点 2/3: TestNode1
2025-09-09 16:44:07,830 - NetworkTopology - INFO - 为节点 TestNode1 配置RSTP网桥...
2025-09-09 16:44:07,830 - NetworkTopology - INFO - 开始为 TestNode1 检测RSTP支持方法...
2025-09-09 16:44:07,830 - NetworkTopology - INFO - TestNode1: 使用缓存的RSTP方法: iproute2
2025-09-09 16:44:07,830 - NetworkTopology - INFO - TestNode1 使用方法: iproute2
2025-09-09 16:44:07,831 - NetworkTopology - INFO - 清理 TestNode1 的旧网桥配置...
2025-09-09 16:44:08,334 - NetworkTopology - INFO - 为 TestNode1 配置RSTP (iproute2)...
2025-09-09 16:44:09,421 - NetworkTopology - INFO - TestNode1: RSTP已通过iproute2配置
2025-09-09 16:44:09,421 - NetworkTopology - INFO - TestNode1 RSTP核心配置完成
2025-09-09 16:44:09,421 - NetworkTopology - INFO - 为 TestNode1 添加接口: ['eth0', 'eth2']
2025-09-09 16:44:09,422 - NetworkTopology - INFO - 添加接口 eth0 到 TestNode1 的网桥
2025-09-09 16:44:09,782 - NetworkTopology - INFO - 添加接口 eth2 到 TestNode1 的网桥
2025-09-09 16:44:10,142 - NetworkTopology - INFO - TestNode1 接口添加完成
2025-09-09 16:44:10,143 - NetworkTopology - INFO - 启动 TestNode1 的网桥 br0...
2025-09-09 16:44:10,328 - NetworkTopology - INFO - 验证 TestNode1 的RSTP配置...
2025-09-09 16:44:10,378 - NetworkTopology - INFO - TestNode1: STP/RSTP已启用
2025-09-09 16:44:10,426 - NetworkTopology - INFO - TestNode1 网桥配置验证完成
2025-09-09 16:44:10,427 - NetworkTopology - INFO - 节点 TestNode1 RSTP配置完成
2025-09-09 16:44:10,427 - NetworkTopology - INFO - 开始配置节点 3/3: TestNode2
2025-09-09 16:44:10,427 - NetworkTopology - INFO - 为节点 TestNode2 配置RSTP网桥...
2025-09-09 16:44:10,427 - NetworkTopology - INFO - 开始为 TestNode2 检测RSTP支持方法...
2025-09-09 16:44:10,427 - NetworkTopology - INFO - TestNode2: 使用缓存的RSTP方法: iproute2
2025-09-09 16:44:10,428 - NetworkTopology - INFO - TestNode2 使用方法: iproute2
2025-09-09 16:44:10,428 - NetworkTopology - INFO - 清理 TestNode2 的旧网桥配置...
2025-09-09 16:44:10,932 - NetworkTopology - INFO - 为 TestNode2 配置RSTP (iproute2)...
2025-09-09 16:44:12,016 - NetworkTopology - INFO - TestNode2: RSTP已通过iproute2配置
2025-09-09 16:44:12,016 - NetworkTopology - INFO - TestNode2 RSTP核心配置完成
2025-09-09 16:44:12,017 - NetworkTopology - INFO - 为 TestNode2 添加接口: ['eth0', 'eth2']
2025-09-09 16:44:12,017 - NetworkTopology - INFO - 添加接口 eth0 到 TestNode2 的网桥
2025-09-09 16:44:12,368 - NetworkTopology - INFO - 添加接口 eth2 到 TestNode2 的网桥
2025-09-09 16:44:12,721 - NetworkTopology - INFO - TestNode2 接口添加完成
2025-09-09 16:44:12,721 - NetworkTopology - INFO - 启动 TestNode2 的网桥 br0...
2025-09-09 16:44:12,900 - NetworkTopology - INFO - 验证 TestNode2 的RSTP配置...
2025-09-09 16:44:12,949 - NetworkTopology - INFO - TestNode2: STP/RSTP已启用
2025-09-09 16:44:12,998 - NetworkTopology - INFO - TestNode2 网桥配置验证完成
2025-09-09 16:44:12,999 - NetworkTopology - INFO - 节点 TestNode2 RSTP配置完成
2025-09-09 16:44:12,999 - NetworkTopology - INFO - 环形拓扑创建完成
2025-09-09 16:44:18,068 - RSTPAnalyzer_DUT - WARNING - 无法获取详细网桥信息，返回默认值: br0
2025-09-09 16:44:18,233 - test_security - INFO - 触发快速拓扑变更...
2025-09-09 16:44:36,611 - RSTPAnalyzer_DUT - WARNING - 无法获取详细网桥信息，返回默认值: br0
2025-09-09 16:44:36,764 - test_security - INFO - 检测到0次拓扑变更
2025-09-09 16:44:36,924 - test_security - INFO - 网络在频繁拓扑变更后保持稳定
2025-09-09 16:44:36,925 - test_security - INFO - 拓扑变更攻击测试完成
2025-09-09 16:44:36,926 - RSTPTest - INFO - 测试完成: test_topology_change_attack (耗时: 30.20秒)
2025-09-09 16:44:36,926 - RSTPTest - INFO - ============================================================

2025-09-09 16:44:36,927 - RSTPTest - INFO - ============================================================
2025-09-09 16:44:36,928 - RSTPTest - INFO - 开始测试: test_mac_spoofing
2025-09-09 16:44:36,928 - RSTPTest - INFO - ============================================================
2025-09-09 16:44:36,928 - test_security - INFO - 开始MAC地址欺骗测试
2025-09-09 16:44:36,929 - NetworkTopology - INFO - 创建RSTP环形拓扑...
2025-09-09 16:44:36,929 - NetworkTopology - INFO - 可用节点数量: 3
2025-09-09 16:44:36,929 - NetworkTopology - INFO - 开始配置节点 1/3: DUT
2025-09-09 16:44:36,929 - NetworkTopology - INFO - 为节点 DUT 配置RSTP网桥...
2025-09-09 16:44:36,929 - NetworkTopology - INFO - 开始为 DUT 检测RSTP支持方法...
2025-09-09 16:44:36,929 - NetworkTopology - INFO - DUT: 使用缓存的RSTP方法: iproute2
2025-09-09 16:44:36,930 - NetworkTopology - INFO - DUT 使用方法: iproute2
2025-09-09 16:44:36,930 - NetworkTopology - INFO - 清理 DUT 的旧网桥配置...
2025-09-09 16:44:37,228 - NetworkTopology - INFO - 为 DUT 配置RSTP (iproute2)...
2025-09-09 16:44:37,620 - NetworkTopology - INFO - DUT: RSTP已通过iproute2配置
2025-09-09 16:44:37,620 - NetworkTopology - INFO - DUT RSTP核心配置完成
2025-09-09 16:44:37,620 - NetworkTopology - INFO - 为 DUT 添加接口: ['eth0', 'eth2']
2025-09-09 16:44:37,620 - NetworkTopology - INFO - 添加接口 eth0 到 DUT 的网桥
2025-09-09 16:44:37,735 - NetworkTopology - INFO - 添加接口 eth2 到 DUT 的网桥
2025-09-09 16:44:37,873 - NetworkTopology - INFO - DUT 接口添加完成
2025-09-09 16:44:37,874 - NetworkTopology - INFO - 启动 DUT 的网桥 rstp0...
2025-09-09 16:44:37,925 - NetworkTopology - INFO - 验证 DUT 的RSTP配置...
2025-09-09 16:44:37,973 - NetworkTopology - INFO - DUT: STP/RSTP已启用
2025-09-09 16:44:38,063 - NetworkTopology - INFO - DUT 网桥配置验证完成
2025-09-09 16:44:38,063 - NetworkTopology - INFO - 节点 DUT RSTP配置完成
2025-09-09 16:44:38,064 - NetworkTopology - INFO - 开始配置节点 2/3: TestNode1
2025-09-09 16:44:38,064 - NetworkTopology - INFO - 为节点 TestNode1 配置RSTP网桥...
2025-09-09 16:44:38,064 - NetworkTopology - INFO - 开始为 TestNode1 检测RSTP支持方法...
2025-09-09 16:44:38,064 - NetworkTopology - INFO - TestNode1: 使用缓存的RSTP方法: iproute2
2025-09-09 16:44:38,065 - NetworkTopology - INFO - TestNode1 使用方法: iproute2
2025-09-09 16:44:38,065 - NetworkTopology - INFO - 清理 TestNode1 的旧网桥配置...
2025-09-09 16:44:38,570 - NetworkTopology - INFO - 为 TestNode1 配置RSTP (iproute2)...
2025-09-09 16:44:39,643 - NetworkTopology - INFO - TestNode1: RSTP已通过iproute2配置
2025-09-09 16:44:39,643 - NetworkTopology - INFO - TestNode1 RSTP核心配置完成
2025-09-09 16:44:39,644 - NetworkTopology - INFO - 为 TestNode1 添加接口: ['eth0', 'eth2']
2025-09-09 16:44:39,644 - NetworkTopology - INFO - 添加接口 eth0 到 TestNode1 的网桥
2025-09-09 16:44:39,995 - NetworkTopology - INFO - 添加接口 eth2 到 TestNode1 的网桥
2025-09-09 16:44:40,334 - NetworkTopology - INFO - TestNode1 接口添加完成
2025-09-09 16:44:40,334 - NetworkTopology - INFO - 启动 TestNode1 的网桥 br0...
2025-09-09 16:44:40,515 - NetworkTopology - INFO - 验证 TestNode1 的RSTP配置...
2025-09-09 16:44:40,563 - NetworkTopology - INFO - TestNode1: STP/RSTP已启用
2025-09-09 16:44:40,613 - NetworkTopology - INFO - TestNode1 网桥配置验证完成
2025-09-09 16:44:40,613 - NetworkTopology - INFO - 节点 TestNode1 RSTP配置完成
2025-09-09 16:44:40,613 - NetworkTopology - INFO - 开始配置节点 3/3: TestNode2
2025-09-09 16:44:40,614 - NetworkTopology - INFO - 为节点 TestNode2 配置RSTP网桥...
2025-09-09 16:44:40,614 - NetworkTopology - INFO - 开始为 TestNode2 检测RSTP支持方法...
2025-09-09 16:44:40,615 - NetworkTopology - INFO - TestNode2: 使用缓存的RSTP方法: iproute2
2025-09-09 16:44:40,615 - NetworkTopology - INFO - TestNode2 使用方法: iproute2
2025-09-09 16:44:40,615 - NetworkTopology - INFO - 清理 TestNode2 的旧网桥配置...
2025-09-09 16:44:41,118 - NetworkTopology - INFO - 为 TestNode2 配置RSTP (iproute2)...
2025-09-09 16:44:42,250 - NetworkTopology - INFO - TestNode2: RSTP已通过iproute2配置
2025-09-09 16:44:42,250 - NetworkTopology - INFO - TestNode2 RSTP核心配置完成
2025-09-09 16:44:42,251 - NetworkTopology - INFO - 为 TestNode2 添加接口: ['eth0', 'eth2']
2025-09-09 16:44:42,251 - NetworkTopology - INFO - 添加接口 eth0 到 TestNode2 的网桥
2025-09-09 16:44:42,588 - NetworkTopology - INFO - 添加接口 eth2 到 TestNode2 的网桥
2025-09-09 16:44:42,947 - NetworkTopology - INFO - TestNode2 接口添加完成
2025-09-09 16:44:42,948 - NetworkTopology - INFO - 启动 TestNode2 的网桥 br0...
2025-09-09 16:44:43,119 - NetworkTopology - INFO - 验证 TestNode2 的RSTP配置...
2025-09-09 16:44:43,169 - NetworkTopology - INFO - TestNode2: STP/RSTP已启用
2025-09-09 16:44:43,218 - NetworkTopology - INFO - TestNode2 网桥配置验证完成
2025-09-09 16:44:43,219 - NetworkTopology - INFO - 节点 TestNode2 RSTP配置完成
2025-09-09 16:44:43,219 - NetworkTopology - INFO - 环形拓扑创建完成
2025-09-09 16:44:48,227 - test_security - INFO - DUT MAC地址: 90:12:10:b5:7d:f7
2025-09-09 16:44:48,227 - test_security - INFO - 尝试MAC地址欺骗...
2025-09-09 16:44:53,852 - test_security - INFO - 网络对MAC欺骗具有抗性
2025-09-09 16:44:54,357 - test_security - INFO - MAC地址欺骗测试完成
2025-09-09 16:44:54,358 - RSTPTest - INFO - 测试完成: test_mac_spoofing (耗时: 17.43秒)
2025-09-09 16:44:54,358 - RSTPTest - INFO - ============================================================

2025-09-09 16:44:54,359 - RSTPTest - INFO - ============================================================
2025-09-09 16:44:54,360 - RSTPTest - INFO - 开始测试: test_port_security
2025-09-09 16:44:54,360 - RSTPTest - INFO - ============================================================
2025-09-09 16:44:54,361 - test_security - INFO - 开始端口安全测试
2025-09-09 16:44:54,366 - test_security - WARNING - 未检测到任何端口安全功能
2025-09-09 16:44:54,367 - RSTPTest - INFO - 测试完成: test_port_security (耗时: 0.01秒)
2025-09-09 16:44:54,367 - RSTPTest - INFO - ============================================================

2025-09-09 16:44:54,369 - RSTPTest - INFO - ============================================================
2025-09-09 16:44:54,369 - RSTPTest - INFO - 开始测试: test_bpdu_filter_functionality
2025-09-09 16:44:54,369 - RSTPTest - INFO - ============================================================
2025-09-09 16:44:54,370 - test_security - INFO - 开始BPDU过滤器功能测试
2025-09-09 16:44:54,411 - NetworkTopology - INFO - 创建RSTP线性拓扑...
2025-09-09 16:44:54,412 - NetworkTopology - INFO - 可用节点数量: 3
2025-09-09 16:44:54,412 - NetworkTopology - INFO - 开始配置节点 1/3: DUT
2025-09-09 16:44:54,412 - NetworkTopology - INFO - 为节点 DUT 配置RSTP网桥...
2025-09-09 16:44:54,412 - NetworkTopology - INFO - 开始为 DUT 检测RSTP支持方法...
2025-09-09 16:44:54,412 - NetworkTopology - INFO - DUT: 使用缓存的RSTP方法: iproute2
2025-09-09 16:44:54,413 - NetworkTopology - INFO - DUT 使用方法: iproute2
2025-09-09 16:44:54,413 - NetworkTopology - INFO - 清理 DUT 的旧网桥配置...
2025-09-09 16:44:54,724 - NetworkTopology - INFO - 为 DUT 配置RSTP (iproute2)...
2025-09-09 16:44:55,115 - NetworkTopology - INFO - DUT: RSTP已通过iproute2配置
2025-09-09 16:44:55,115 - NetworkTopology - INFO - DUT RSTP核心配置完成
2025-09-09 16:44:55,115 - NetworkTopology - INFO - 为 DUT 添加接口: ['eth2']
2025-09-09 16:44:55,116 - NetworkTopology - INFO - 添加接口 eth2 到 DUT 的网桥
2025-09-09 16:44:55,235 - NetworkTopology - INFO - DUT 接口添加完成
2025-09-09 16:44:55,235 - NetworkTopology - INFO - 启动 DUT 的网桥 rstp0...
2025-09-09 16:44:55,292 - NetworkTopology - INFO - 验证 DUT 的RSTP配置...
2025-09-09 16:44:55,340 - NetworkTopology - INFO - DUT: STP/RSTP已启用
2025-09-09 16:44:55,388 - NetworkTopology - INFO - DUT 网桥配置验证完成
2025-09-09 16:44:55,388 - NetworkTopology - INFO - 节点 DUT RSTP配置完成
2025-09-09 16:44:55,389 - NetworkTopology - INFO - 开始配置节点 2/3: TestNode1
2025-09-09 16:44:55,389 - NetworkTopology - INFO - 为节点 TestNode1 配置RSTP网桥...
2025-09-09 16:44:55,389 - NetworkTopology - INFO - 开始为 TestNode1 检测RSTP支持方法...
2025-09-09 16:44:55,389 - NetworkTopology - INFO - TestNode1: 使用缓存的RSTP方法: iproute2
2025-09-09 16:44:55,390 - NetworkTopology - INFO - TestNode1 使用方法: iproute2
2025-09-09 16:44:55,390 - NetworkTopology - INFO - 清理 TestNode1 的旧网桥配置...
2025-09-09 16:44:55,888 - NetworkTopology - INFO - 为 TestNode1 配置RSTP (iproute2)...
2025-09-09 16:44:56,988 - NetworkTopology - INFO - TestNode1: RSTP已通过iproute2配置
2025-09-09 16:44:56,988 - NetworkTopology - INFO - TestNode1 RSTP核心配置完成
2025-09-09 16:44:56,989 - NetworkTopology - INFO - 为 TestNode1 添加接口: ['eth0', 'eth2']
2025-09-09 16:44:56,989 - NetworkTopology - INFO - 添加接口 eth0 到 TestNode1 的网桥
2025-09-09 16:44:57,333 - NetworkTopology - INFO - 添加接口 eth2 到 TestNode1 的网桥
2025-09-09 16:44:57,697 - NetworkTopology - INFO - TestNode1 接口添加完成
2025-09-09 16:44:57,697 - NetworkTopology - INFO - 启动 TestNode1 的网桥 br0...
2025-09-09 16:44:57,889 - NetworkTopology - INFO - 验证 TestNode1 的RSTP配置...
2025-09-09 16:44:57,938 - NetworkTopology - INFO - TestNode1: STP/RSTP已启用
2025-09-09 16:44:57,987 - NetworkTopology - INFO - TestNode1 网桥配置验证完成
2025-09-09 16:44:57,987 - NetworkTopology - INFO - 节点 TestNode1 RSTP配置完成
2025-09-09 16:44:57,988 - NetworkTopology - INFO - 开始配置节点 3/3: TestNode2
2025-09-09 16:44:57,988 - NetworkTopology - INFO - 为节点 TestNode2 配置RSTP网桥...
2025-09-09 16:44:57,988 - NetworkTopology - INFO - 开始为 TestNode2 检测RSTP支持方法...
2025-09-09 16:44:57,988 - NetworkTopology - INFO - TestNode2: 使用缓存的RSTP方法: iproute2
2025-09-09 16:44:57,989 - NetworkTopology - INFO - TestNode2 使用方法: iproute2
2025-09-09 16:44:57,989 - NetworkTopology - INFO - 清理 TestNode2 的旧网桥配置...
2025-09-09 16:44:58,499 - NetworkTopology - INFO - 为 TestNode2 配置RSTP (iproute2)...
2025-09-09 16:44:59,658 - NetworkTopology - INFO - TestNode2: RSTP已通过iproute2配置
2025-09-09 16:44:59,658 - NetworkTopology - INFO - TestNode2 RSTP核心配置完成
2025-09-09 16:44:59,658 - NetworkTopology - INFO - 为 TestNode2 添加接口: ['eth0']
2025-09-09 16:44:59,659 - NetworkTopology - INFO - 添加接口 eth0 到 TestNode2 的网桥
2025-09-09 16:45:00,012 - NetworkTopology - INFO - TestNode2 接口添加完成
2025-09-09 16:45:00,013 - NetworkTopology - INFO - 启动 TestNode2 的网桥 br0...
2025-09-09 16:45:00,190 - NetworkTopology - INFO - 验证 TestNode2 的RSTP配置...
2025-09-09 16:45:00,238 - NetworkTopology - INFO - TestNode2: STP/RSTP已启用
2025-09-09 16:45:00,287 - NetworkTopology - INFO - TestNode2 网桥配置验证完成
2025-09-09 16:45:00,287 - NetworkTopology - INFO - 节点 TestNode2 RSTP配置完成
2025-09-09 16:45:00,288 - NetworkTopology - INFO - 线性拓扑创建完成
2025-09-09 16:45:05,373 - test_security - WARNING - BPDU包统计命令执行失败: 
2025-09-09 16:45:05,373 - test_security - INFO - 启用过滤器前端口 eth2 BPDU数量: 0
2025-09-09 16:45:05,456 - test_security - WARNING - mstpctl设置BPDU过滤器失败，尝试使用brctl
2025-09-09 16:45:05,506 - test_security - ERROR - 启用BPDU过滤器失败: BPDU过滤器配置失败: 
2025-09-09 16:45:05,507 - test_security - ERROR - 启用BPDU过滤器失败: BPDU过滤器配置失败: 
2025-09-09 16:45:05,604 - test_security - WARNING - 清理命令执行失败: mstpctl setportbpdufilter br0 eth2 no, 错误: 
2025-09-09 16:45:05,701 - test_security - WARNING - 清理命令执行失败: echo 0 > /sys/class/net/br0/bridge/ports/eth2/bpdu_filter, 错误: 
2025-09-09 16:45:06,101 - RSTPTest - INFO - 测试完成: test_bpdu_filter_functionality (耗时: 11.73秒)
2025-09-09 16:45:06,101 - RSTPTest - INFO - ============================================================

2025-09-09 16:45:06,102 - RSTPTest - INFO - ============================================================
2025-09-09 16:45:06,103 - RSTPTest - INFO - 开始测试: test_malformed_bpdu_handling
2025-09-09 16:45:06,103 - RSTPTest - INFO - ============================================================
2025-09-09 16:45:06,103 - test_security - INFO - 开始畸形BPDU处理测试
2025-09-09 16:45:06,108 - NetworkTopology - INFO - 创建RSTP环形拓扑...
2025-09-09 16:45:06,109 - NetworkTopology - INFO - 可用节点数量: 3
2025-09-09 16:45:06,109 - NetworkTopology - INFO - 开始配置节点 1/3: DUT
2025-09-09 16:45:06,109 - NetworkTopology - INFO - 为节点 DUT 配置RSTP网桥...
2025-09-09 16:45:06,109 - NetworkTopology - INFO - 开始为 DUT 检测RSTP支持方法...
2025-09-09 16:45:06,110 - NetworkTopology - INFO - DUT: 使用缓存的RSTP方法: iproute2
2025-09-09 16:45:06,110 - NetworkTopology - INFO - DUT 使用方法: iproute2
2025-09-09 16:45:06,110 - NetworkTopology - INFO - 清理 DUT 的旧网桥配置...
2025-09-09 16:45:06,427 - NetworkTopology - INFO - 为 DUT 配置RSTP (iproute2)...
2025-09-09 16:45:06,819 - NetworkTopology - INFO - DUT: RSTP已通过iproute2配置
2025-09-09 16:45:06,819 - NetworkTopology - INFO - DUT RSTP核心配置完成
2025-09-09 16:45:06,820 - NetworkTopology - INFO - 为 DUT 添加接口: ['eth0', 'eth2']
2025-09-09 16:45:06,820 - NetworkTopology - INFO - 添加接口 eth0 到 DUT 的网桥
2025-09-09 16:45:06,935 - NetworkTopology - INFO - 添加接口 eth2 到 DUT 的网桥
2025-09-09 16:45:07,055 - NetworkTopology - INFO - DUT 接口添加完成
2025-09-09 16:45:07,055 - NetworkTopology - INFO - 启动 DUT 的网桥 rstp0...
2025-09-09 16:45:07,112 - NetworkTopology - INFO - 验证 DUT 的RSTP配置...
2025-09-09 16:45:07,160 - NetworkTopology - INFO - DUT: STP/RSTP已启用
2025-09-09 16:45:07,208 - NetworkTopology - INFO - DUT 网桥配置验证完成
2025-09-09 16:45:07,209 - NetworkTopology - INFO - 节点 DUT RSTP配置完成
2025-09-09 16:45:07,209 - NetworkTopology - INFO - 开始配置节点 2/3: TestNode1
2025-09-09 16:45:07,209 - NetworkTopology - INFO - 为节点 TestNode1 配置RSTP网桥...
2025-09-09 16:45:07,209 - NetworkTopology - INFO - 开始为 TestNode1 检测RSTP支持方法...
2025-09-09 16:45:07,210 - NetworkTopology - INFO - TestNode1: 使用缓存的RSTP方法: iproute2
2025-09-09 16:45:07,210 - NetworkTopology - INFO - TestNode1 使用方法: iproute2
2025-09-09 16:45:07,210 - NetworkTopology - INFO - 清理 TestNode1 的旧网桥配置...
2025-09-09 16:45:07,707 - NetworkTopology - INFO - 为 TestNode1 配置RSTP (iproute2)...
2025-09-09 16:45:08,792 - NetworkTopology - INFO - TestNode1: RSTP已通过iproute2配置
2025-09-09 16:45:08,792 - NetworkTopology - INFO - TestNode1 RSTP核心配置完成
2025-09-09 16:45:08,792 - NetworkTopology - INFO - 为 TestNode1 添加接口: ['eth0', 'eth2']
2025-09-09 16:45:08,793 - NetworkTopology - INFO - 添加接口 eth0 到 TestNode1 的网桥
2025-09-09 16:45:09,151 - NetworkTopology - INFO - 添加接口 eth2 到 TestNode1 的网桥
2025-09-09 16:45:09,473 - NetworkTopology - INFO - TestNode1 接口添加完成
2025-09-09 16:45:09,474 - NetworkTopology - INFO - 启动 TestNode1 的网桥 br0...
2025-09-09 16:45:09,683 - NetworkTopology - INFO - 验证 TestNode1 的RSTP配置...
2025-09-09 16:45:09,732 - NetworkTopology - INFO - TestNode1: STP/RSTP已启用
2025-09-09 16:45:09,779 - NetworkTopology - INFO - TestNode1 网桥配置验证完成
2025-09-09 16:45:09,780 - NetworkTopology - INFO - 节点 TestNode1 RSTP配置完成
2025-09-09 16:45:09,780 - NetworkTopology - INFO - 开始配置节点 3/3: TestNode2
2025-09-09 16:45:09,780 - NetworkTopology - INFO - 为节点 TestNode2 配置RSTP网桥...
2025-09-09 16:45:09,780 - NetworkTopology - INFO - 开始为 TestNode2 检测RSTP支持方法...
2025-09-09 16:45:09,781 - NetworkTopology - INFO - TestNode2: 使用缓存的RSTP方法: iproute2
2025-09-09 16:45:09,781 - NetworkTopology - INFO - TestNode2 使用方法: iproute2
2025-09-09 16:45:09,781 - NetworkTopology - INFO - 清理 TestNode2 的旧网桥配置...
2025-09-09 16:45:10,271 - NetworkTopology - INFO - 为 TestNode2 配置RSTP (iproute2)...
2025-09-09 16:45:11,384 - NetworkTopology - INFO - TestNode2: RSTP已通过iproute2配置
2025-09-09 16:45:11,385 - NetworkTopology - INFO - TestNode2 RSTP核心配置完成
2025-09-09 16:45:11,385 - NetworkTopology - INFO - 为 TestNode2 添加接口: ['eth0', 'eth2']
2025-09-09 16:45:11,385 - NetworkTopology - INFO - 添加接口 eth0 到 TestNode2 的网桥
2025-09-09 16:45:11,714 - NetworkTopology - INFO - 添加接口 eth2 到 TestNode2 的网桥
2025-09-09 16:45:12,103 - NetworkTopology - INFO - TestNode2 接口添加完成
2025-09-09 16:45:12,104 - NetworkTopology - INFO - 启动 TestNode2 的网桥 br0...
2025-09-09 16:45:12,278 - NetworkTopology - INFO - 验证 TestNode2 的RSTP配置...
2025-09-09 16:45:12,325 - NetworkTopology - INFO - TestNode2: STP/RSTP已启用
2025-09-09 16:45:12,373 - NetworkTopology - INFO - TestNode2 网桥配置验证完成
2025-09-09 16:45:12,374 - NetworkTopology - INFO - 节点 TestNode2 RSTP配置完成
2025-09-09 16:45:12,374 - NetworkTopology - INFO - 环形拓扑创建完成
2025-09-09 16:45:17,438 - RSTPAnalyzer_DUT - WARNING - 无法获取详细网桥信息，返回默认值: br0
2025-09-09 16:45:17,748 - test_security - INFO - 初始网络状态: 稳定
2025-09-09 16:45:17,748 - test_security - INFO - 执行测试: _test_oversized_bpdu
2025-09-09 16:45:21,828 - test_security - INFO - _test_oversized_bpdu 网络保持稳定
2025-09-09 16:45:21,828 - test_security - INFO - 执行测试: _test_undersized_bpdu
2025-09-09 16:45:21,836 - SSH_TestNode1 - ERROR - 命令执行失败 [TestNode1]: echo '
from scapy.all import *

# 创建过小的BPDU（缺少必要字段）
target_mac = "01:80:c2:00:00:00"
interface = "eth0"

eth = Ether(dst=target_mac, src="00:11:22:33:44:55")
llc = LLC(dsap=0x42, ssap=0x42, ctrl=0x03)
# 只包含最小字段的BPDU
truncated_bpdu = Raw(load=b"     ")  # 截断的BPDU

packet = eth/llc/truncated_bpdu
sendp(packet, iface=interface, count=5, inter=1, verbose=0)
print("Undersized BPDU sent")
' > /tmp/undersized_bpdu.py
错误: 
2025-09-09 16:45:21,837 - test_security - ERROR - _test_undersized_bpdu 执行失败: 
2025-09-09 16:45:21,837 - test_security - INFO - 执行测试: _test_invalid_protocol_id
2025-09-09 16:45:21,837 - SSH_TestNode1 - ERROR - 命令执行失败 [TestNode1]: echo '
from scapy.all import *

target_mac = "01:80:c2:00:00:00"
interface = "eth0"

eth = Ether(dst=target_mac, src="00:11:22:33:44:55")
llc = LLC(dsap=0x42, ssap=0x42, ctrl=0x03)
# 使用无效的协议ID（正常应该是0x0000）
invalid_bpdu = Raw(load=b"ÿÿ   " + b" " * 30)

packet = eth/llc/invalid_bpdu
sendp(packet, iface=interface, count=5, inter=1, verbose=0)
print("Invalid protocol ID BPDU sent")
' > /tmp/invalid_protocol.py
错误: SSH session not active
2025-09-09 16:45:21,838 - test_security - ERROR - _test_invalid_protocol_id 执行失败: SSH session not active
2025-09-09 16:45:21,838 - test_security - INFO - 执行测试: _test_invalid_version
2025-09-09 16:45:21,838 - SSH_TestNode1 - ERROR - 命令执行失败 [TestNode1]: echo '
from scapy.all import *

target_mac = "01:80:c2:00:00:00"
interface = "eth0"

eth = Ether(dst=target_mac, src="00:11:22:33:44:55")
llc = LLC(dsap=0x42, ssap=0x42, ctrl=0x03)
# 使用无效版本号（正常RSTP应该是2）
invalid_version_bpdu = Raw(load=b"  ÿ  " + b" " * 30)

packet = eth/llc/invalid_version_bpdu
sendp(packet, iface=interface, count=5, inter=1, verbose=0)
print("Invalid version BPDU sent")
' > /tmp/invalid_version.py
错误: SSH session not active
2025-09-09 16:45:21,839 - test_security - ERROR - _test_invalid_version 执行失败: SSH session not active
2025-09-09 16:45:21,839 - test_security - INFO - 执行测试: _test_invalid_message_type
2025-09-09 16:45:21,839 - SSH_TestNode1 - ERROR - 命令执行失败 [TestNode1]: echo '
from scapy.all import *

target_mac = "01:80:c2:00:00:00"
interface = "eth0"

eth = Ether(dst=target_mac, src="00:11:22:33:44:55")
llc = LLC(dsap=0x42, ssap=0x42, ctrl=0x03)
# 使用无效消息类型（正常配置BPDU是0x00，TCN是0x80）
invalid_type_bpdu = Raw(load=b"  ÿ " + b" " * 30)

packet = eth/llc/invalid_type_bpdu
sendp(packet, iface=interface, count=5, inter=1, verbose=0)
print("Invalid message type BPDU sent")
' > /tmp/invalid_type.py
错误: SSH session not active
2025-09-09 16:45:21,840 - test_security - ERROR - _test_invalid_message_type 执行失败: SSH session not active
2025-09-09 16:45:21,841 - test_security - INFO - 执行测试: _test_corrupted_fields
2025-09-09 16:45:21,841 - SSH_TestNode1 - ERROR - 命令执行失败 [TestNode1]: echo '
from scapy.all import *
import random

target_mac = "01:80:c2:00:00:00"
interface = "eth0"

eth = Ether(dst=target_mac, src="00:11:22:33:44:55")
llc = LLC(dsap=0x42, ssap=0x42, ctrl=0x03)

# 创建包含随机损坏数据的BPDU
corrupted_data = bytes([random.randint(0, 255) for _ in range(36)])
corrupted_bpdu = Raw(load=corrupted_data)

packet = eth/llc/corrupted_bpdu
sendp(packet, iface=interface, count=5, inter=1, verbose=0)
print("Corrupted BPDU sent")
' > /tmp/corrupted_bpdu.py
错误: SSH session not active
2025-09-09 16:45:21,842 - test_security - ERROR - _test_corrupted_fields 执行失败: SSH session not active
2025-09-09 16:45:24,953 - RSTPTest - INFO - 测试完成: test_malformed_bpdu_handling (耗时: 18.85秒)
2025-09-09 16:45:24,953 - RSTPTest - INFO - ============================================================

2025-09-09 16:45:24,955 - RSTPTest - INFO - ============================================================
2025-09-09 16:45:24,955 - RSTPTest - INFO - 开始测试: test_non_standard_bpdu_handling
2025-09-09 16:45:24,955 - RSTPTest - INFO - ============================================================
2025-09-09 16:45:24,956 - test_security - INFO - 开始非标准BPDU处理测试
2025-09-09 16:45:24,961 - NetworkTopology - INFO - 创建RSTP环形拓扑...
2025-09-09 16:45:24,961 - NetworkTopology - INFO - 可用节点数量: 3
2025-09-09 16:45:24,961 - NetworkTopology - INFO - 开始配置节点 1/3: DUT
2025-09-09 16:45:24,961 - NetworkTopology - INFO - 为节点 DUT 配置RSTP网桥...
2025-09-09 16:45:24,961 - NetworkTopology - INFO - 开始为 DUT 检测RSTP支持方法...
2025-09-09 16:45:24,962 - NetworkTopology - INFO - DUT: 使用缓存的RSTP方法: iproute2
2025-09-09 16:45:24,962 - NetworkTopology - INFO - DUT 使用方法: iproute2
2025-09-09 16:45:24,962 - NetworkTopology - INFO - 清理 DUT 的旧网桥配置...
2025-09-09 16:45:25,247 - NetworkTopology - INFO - 为 DUT 配置RSTP (iproute2)...
2025-09-09 16:45:25,647 - NetworkTopology - INFO - DUT: RSTP已通过iproute2配置
2025-09-09 16:45:25,647 - NetworkTopology - INFO - DUT RSTP核心配置完成
2025-09-09 16:45:25,647 - NetworkTopology - INFO - 为 DUT 添加接口: ['eth0', 'eth2']
2025-09-09 16:45:25,647 - NetworkTopology - INFO - 添加接口 eth0 到 DUT 的网桥
2025-09-09 16:45:25,766 - NetworkTopology - INFO - 添加接口 eth2 到 DUT 的网桥
2025-09-09 16:45:25,887 - NetworkTopology - INFO - DUT 接口添加完成
2025-09-09 16:45:25,887 - NetworkTopology - INFO - 启动 DUT 的网桥 rstp0...
2025-09-09 16:45:25,943 - NetworkTopology - INFO - 验证 DUT 的RSTP配置...
2025-09-09 16:45:25,992 - NetworkTopology - INFO - DUT: STP/RSTP已启用
2025-09-09 16:45:26,039 - NetworkTopology - INFO - DUT 网桥配置验证完成
2025-09-09 16:45:26,040 - NetworkTopology - INFO - 节点 DUT RSTP配置完成
2025-09-09 16:45:26,040 - NetworkTopology - INFO - 开始配置节点 2/3: TestNode1
2025-09-09 16:45:26,040 - NetworkTopology - INFO - 为节点 TestNode1 配置RSTP网桥...
2025-09-09 16:45:26,040 - NetworkTopology - INFO - 开始为 TestNode1 检测RSTP支持方法...
2025-09-09 16:45:26,040 - NetworkTopology - INFO - TestNode1: 使用缓存的RSTP方法: iproute2
2025-09-09 16:45:26,041 - NetworkTopology - INFO - TestNode1 使用方法: iproute2
2025-09-09 16:45:26,041 - NetworkTopology - INFO - 清理 TestNode1 的旧网桥配置...
2025-09-09 16:45:26,041 - SSH_TestNode1 - ERROR - sudo命令执行失败 [TestNode1]: sudo ip link set dev br0 down 2>/dev/null || true
错误: SSH session not active
2025-09-09 16:45:26,041 - NetworkTopology - ERROR - 配置节点 TestNode1 失败: SSH session not active
2025-09-09 16:45:26,041 - test_security - ERROR - 非标准BPDU处理测试失败: SSH session not active
2025-09-09 16:45:26,302 - RSTPTest - INFO - 测试完成: test_non_standard_bpdu_handling (耗时: 1.35秒)
2025-09-09 16:45:26,303 - RSTPTest - INFO - ============================================================

2025-09-09 16:45:26,304 - RSTPTest - INFO - ============================================================
2025-09-09 16:45:26,305 - RSTPTest - INFO - 开始测试: test_bpdu_guard_functionality
2025-09-09 16:45:26,305 - RSTPTest - INFO - ============================================================
2025-09-09 16:45:26,305 - test_security - INFO - 开始BPDU防护功能测试
2025-09-09 16:45:26,310 - NetworkTopology - INFO - 创建RSTP线性拓扑...
2025-09-09 16:45:26,310 - NetworkTopology - INFO - 可用节点数量: 3
2025-09-09 16:45:26,311 - NetworkTopology - INFO - 开始配置节点 1/3: DUT
2025-09-09 16:45:26,311 - NetworkTopology - INFO - 为节点 DUT 配置RSTP网桥...
2025-09-09 16:45:26,311 - NetworkTopology - INFO - 开始为 DUT 检测RSTP支持方法...
2025-09-09 16:45:26,311 - NetworkTopology - INFO - DUT: 使用缓存的RSTP方法: iproute2
2025-09-09 16:45:26,311 - NetworkTopology - INFO - DUT 使用方法: iproute2
2025-09-09 16:45:26,312 - NetworkTopology - INFO - 清理 DUT 的旧网桥配置...
2025-09-09 16:45:26,615 - NetworkTopology - INFO - 为 DUT 配置RSTP (iproute2)...
2025-09-09 16:45:27,006 - NetworkTopology - INFO - DUT: RSTP已通过iproute2配置
2025-09-09 16:45:27,007 - NetworkTopology - INFO - DUT RSTP核心配置完成
2025-09-09 16:45:27,007 - NetworkTopology - INFO - 为 DUT 添加接口: ['eth2']
2025-09-09 16:45:27,007 - NetworkTopology - INFO - 添加接口 eth2 到 DUT 的网桥
2025-09-09 16:45:27,122 - NetworkTopology - INFO - DUT 接口添加完成
2025-09-09 16:45:27,123 - NetworkTopology - INFO - 启动 DUT 的网桥 rstp0...
2025-09-09 16:45:27,179 - NetworkTopology - INFO - 验证 DUT 的RSTP配置...
2025-09-09 16:45:27,227 - NetworkTopology - INFO - DUT: STP/RSTP已启用
2025-09-09 16:45:27,276 - NetworkTopology - INFO - DUT 网桥配置验证完成
2025-09-09 16:45:27,276 - NetworkTopology - INFO - 节点 DUT RSTP配置完成
2025-09-09 16:45:27,277 - NetworkTopology - INFO - 开始配置节点 2/3: TestNode1
2025-09-09 16:45:27,277 - NetworkTopology - INFO - 为节点 TestNode1 配置RSTP网桥...
2025-09-09 16:45:27,277 - NetworkTopology - INFO - 开始为 TestNode1 检测RSTP支持方法...
2025-09-09 16:45:27,277 - NetworkTopology - INFO - TestNode1: 使用缓存的RSTP方法: iproute2
2025-09-09 16:45:27,277 - NetworkTopology - INFO - TestNode1 使用方法: iproute2
2025-09-09 16:45:27,278 - NetworkTopology - INFO - 清理 TestNode1 的旧网桥配置...
2025-09-09 16:45:27,278 - SSH_TestNode1 - ERROR - sudo命令执行失败 [TestNode1]: sudo ip link set dev br0 down 2>/dev/null || true
错误: SSH session not active
2025-09-09 16:45:27,278 - NetworkTopology - ERROR - 配置节点 TestNode1 失败: SSH session not active
2025-09-09 16:45:27,278 - test_security - ERROR - BPDU防护测试失败: SSH session not active
2025-09-09 16:45:27,473 - RSTPTest - INFO - 测试完成: test_bpdu_guard_functionality (耗时: 1.17秒)
2025-09-09 16:45:27,473 - RSTPTest - INFO - ============================================================

2025-09-09 16:45:27,474 - RSTPTest - INFO - ============================================================
2025-09-09 16:45:27,475 - RSTPTest - INFO - 开始测试: test_root_guard_functionality
2025-09-09 16:45:27,475 - RSTPTest - INFO - ============================================================
2025-09-09 16:45:27,475 - test_security - INFO - 开始根防护功能测试
2025-09-09 16:45:27,480 - NetworkTopology - INFO - 创建RSTP环形拓扑...
2025-09-09 16:45:27,480 - NetworkTopology - INFO - 可用节点数量: 3
2025-09-09 16:45:27,481 - NetworkTopology - INFO - 开始配置节点 1/3: DUT
2025-09-09 16:45:27,481 - NetworkTopology - INFO - 为节点 DUT 配置RSTP网桥...
2025-09-09 16:45:27,481 - NetworkTopology - INFO - 开始为 DUT 检测RSTP支持方法...
2025-09-09 16:45:27,481 - NetworkTopology - INFO - DUT: 使用缓存的RSTP方法: iproute2
2025-09-09 16:45:27,481 - NetworkTopology - INFO - DUT 使用方法: iproute2
2025-09-09 16:45:27,481 - NetworkTopology - INFO - 清理 DUT 的旧网桥配置...
2025-09-09 16:45:27,795 - NetworkTopology - INFO - 为 DUT 配置RSTP (iproute2)...
2025-09-09 16:45:28,191 - NetworkTopology - INFO - DUT: RSTP已通过iproute2配置
2025-09-09 16:45:28,191 - NetworkTopology - INFO - DUT RSTP核心配置完成
2025-09-09 16:45:28,192 - NetworkTopology - INFO - 为 DUT 添加接口: ['eth0', 'eth2']
2025-09-09 16:45:28,192 - NetworkTopology - INFO - 添加接口 eth0 到 DUT 的网桥
2025-09-09 16:45:28,310 - NetworkTopology - INFO - 添加接口 eth2 到 DUT 的网桥
2025-09-09 16:45:28,426 - NetworkTopology - INFO - DUT 接口添加完成
2025-09-09 16:45:28,427 - NetworkTopology - INFO - 启动 DUT 的网桥 rstp0...
2025-09-09 16:45:28,483 - NetworkTopology - INFO - 验证 DUT 的RSTP配置...
2025-09-09 16:45:28,532 - NetworkTopology - INFO - DUT: STP/RSTP已启用
2025-09-09 16:45:28,579 - NetworkTopology - INFO - DUT 网桥配置验证完成
2025-09-09 16:45:28,579 - NetworkTopology - INFO - 节点 DUT RSTP配置完成
2025-09-09 16:45:28,580 - NetworkTopology - INFO - 开始配置节点 2/3: TestNode1
2025-09-09 16:45:28,580 - NetworkTopology - INFO - 为节点 TestNode1 配置RSTP网桥...
2025-09-09 16:45:28,580 - NetworkTopology - INFO - 开始为 TestNode1 检测RSTP支持方法...
2025-09-09 16:45:28,580 - NetworkTopology - INFO - TestNode1: 使用缓存的RSTP方法: iproute2
2025-09-09 16:45:28,580 - NetworkTopology - INFO - TestNode1 使用方法: iproute2
2025-09-09 16:45:28,580 - NetworkTopology - INFO - 清理 TestNode1 的旧网桥配置...
2025-09-09 16:45:28,580 - SSH_TestNode1 - ERROR - sudo命令执行失败 [TestNode1]: sudo ip link set dev br0 down 2>/dev/null || true
错误: SSH session not active
2025-09-09 16:45:28,581 - NetworkTopology - ERROR - 配置节点 TestNode1 失败: SSH session not active
2025-09-09 16:45:28,581 - test_security - ERROR - 根防护测试失败: SSH session not active
2025-09-09 16:45:28,803 - RSTPTest - INFO - 测试完成: test_root_guard_functionality (耗时: 1.33秒)
2025-09-09 16:45:28,804 - RSTPTest - INFO - ============================================================

2025-09-09 16:45:28,805 - RSTPTest - INFO - ============================================================
2025-09-09 16:45:28,805 - RSTPTest - INFO - 开始测试: test_loop_guard_functionality
2025-09-09 16:45:28,806 - RSTPTest - INFO - ============================================================
2025-09-09 16:45:28,806 - test_security - INFO - 开始环路防护功能测试
2025-09-09 16:45:28,806 - NetworkTopology - INFO - 创建RSTP环形拓扑...
2025-09-09 16:45:28,807 - NetworkTopology - INFO - 可用节点数量: 3
2025-09-09 16:45:28,807 - NetworkTopology - INFO - 开始配置节点 1/3: DUT
2025-09-09 16:45:28,807 - NetworkTopology - INFO - 为节点 DUT 配置RSTP网桥...
2025-09-09 16:45:28,807 - NetworkTopology - INFO - 开始为 DUT 检测RSTP支持方法...
2025-09-09 16:45:28,807 - NetworkTopology - INFO - DUT: 使用缓存的RSTP方法: iproute2
2025-09-09 16:45:28,807 - NetworkTopology - INFO - DUT 使用方法: iproute2
2025-09-09 16:45:28,807 - NetworkTopology - INFO - 清理 DUT 的旧网桥配置...
2025-09-09 16:45:29,079 - NetworkTopology - INFO - 为 DUT 配置RSTP (iproute2)...
2025-09-09 16:45:29,470 - NetworkTopology - INFO - DUT: RSTP已通过iproute2配置
2025-09-09 16:45:29,470 - NetworkTopology - INFO - DUT RSTP核心配置完成
2025-09-09 16:45:29,471 - NetworkTopology - INFO - 为 DUT 添加接口: ['eth0', 'eth2']
2025-09-09 16:45:29,471 - NetworkTopology - INFO - 添加接口 eth0 到 DUT 的网桥
2025-09-09 16:45:29,587 - NetworkTopology - INFO - 添加接口 eth2 到 DUT 的网桥
2025-09-09 16:45:29,706 - NetworkTopology - INFO - DUT 接口添加完成
2025-09-09 16:45:29,707 - NetworkTopology - INFO - 启动 DUT 的网桥 rstp0...
2025-09-09 16:45:29,763 - NetworkTopology - INFO - 验证 DUT 的RSTP配置...
2025-09-09 16:45:29,811 - NetworkTopology - INFO - DUT: STP/RSTP已启用
2025-09-09 16:45:29,861 - NetworkTopology - INFO - DUT 网桥配置验证完成
2025-09-09 16:45:29,861 - NetworkTopology - INFO - 节点 DUT RSTP配置完成
2025-09-09 16:45:29,861 - NetworkTopology - INFO - 开始配置节点 2/3: TestNode1
2025-09-09 16:45:29,861 - NetworkTopology - INFO - 为节点 TestNode1 配置RSTP网桥...
2025-09-09 16:45:29,861 - NetworkTopology - INFO - 开始为 TestNode1 检测RSTP支持方法...
2025-09-09 16:45:29,862 - NetworkTopology - INFO - TestNode1: 使用缓存的RSTP方法: iproute2
2025-09-09 16:45:29,862 - NetworkTopology - INFO - TestNode1 使用方法: iproute2
2025-09-09 16:45:29,862 - NetworkTopology - INFO - 清理 TestNode1 的旧网桥配置...
2025-09-09 16:45:29,862 - SSH_TestNode1 - ERROR - sudo命令执行失败 [TestNode1]: sudo ip link set dev br0 down 2>/dev/null || true
错误: SSH session not active
2025-09-09 16:45:29,862 - NetworkTopology - ERROR - 配置节点 TestNode1 失败: SSH session not active
2025-09-09 16:45:29,862 - test_security - ERROR - 环路防护测试失败: SSH session not active
2025-09-09 16:45:29,970 - test_security - INFO - 环路防护功能测试完成
2025-09-09 16:45:29,971 - RSTPTest - INFO - 测试完成: test_loop_guard_functionality (耗时: 1.17秒)
2025-09-09 16:45:29,971 - RSTPTest - INFO - ============================================================

2025-09-09 16:45:29,972 - SSH_TestNode1 - INFO - SSH连接已关闭: TestNode1
2025-09-09 16:45:29,972 - SSH_TestNode2 - INFO - SSH连接已关闭: TestNode2
2025-09-09 16:45:29,972 - SSH_DUT - INFO - SSH连接已关闭: DUT
